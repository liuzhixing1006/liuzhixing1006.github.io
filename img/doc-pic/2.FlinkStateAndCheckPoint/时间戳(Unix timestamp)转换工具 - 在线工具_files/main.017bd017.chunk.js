(this["webpackJsonpcomment-fe"]=this["webpackJsonpcomment-fe"]||[]).push([[0],{121:function(t,e,n){t.exports={"comment-form":"CommentForm_comment-form__1pc5A"}},124:function(t,e,n){t.exports={"comment-toolbar":"CommentToolBar_comment-toolbar__1b09k"}},125:function(t,e,n){t.exports={"comment-list":"CommentList_comment-list__2xEIu"}},128:function(t,e,n){t.exports={"comment-line":"CommentBox_comment-line__3wofz"}},135:function(t,e,n){t.exports=n(251)},250:function(t,e,n){},251:function(t,e,n){"use strict";n.r(e);var o=n(0),m=n.n(o),a=n(6),c=n.n(a),r=n(54),l=n(35),u=n(120),i=n.n(u),s=(n(148),n(131)),p=(n(150),n(132)),h=n(21),d=n(22),C=n(24),_=n(23),b=n(25),y=(n(252),n(129)),f=(n(154),n(126)),E=n(27),v=(n(156),n(91)),O=(n(57),n(10)),j=(n(159),n(69)),S=(n(93),n(56)),I=(n(162),n(130)),q=n(89),g=n.n(q),N=function(t,e){return{type:"CHANGE_FORM",payload:{replyCommentId:t,replyRootCommentId:e}}},k=function(t){return{type:"SUBMIT_COMMENT",payload:{replyCommentId:null,request:g()({method:"post",url:"//tool.lu/comment/"+window._commentAppState.objectType+"/"+window._commentAppState.objectId+"/add",data:{comment:t}})}}},w=function(t){return{type:"FETCH_COMMENTS",payload:{request:g()({method:"get",url:"//tool.lu/comment/"+window._commentAppState.objectType+"/"+window._commentAppState.objectId+"/comments",params:{page:t}})}}},T=function(t,e){return{type:"FETCH_COMMENTS_SUCCESS",payload:{total:t,comments:e}}},M=n(121),x=n.n(M),F=I.a.TextArea,R=function(t){function e(t){var n;return Object(h.a)(this,e),(n=Object(C.a)(this,Object(_.a)(e).call(this,t))).handleContentChange=n.handleContentChange.bind(Object(E.a)(n)),n.submitComment=n.submitComment.bind(Object(E.a)(n)),n.hotKeySubmit=n.hotKeySubmit.bind(Object(E.a)(n)),n.state={content:""},n}return Object(b.a)(e,t),Object(d.a)(e,[{key:"render",value:function(){return m.a.createElement("form",{className:x.a["comment-form"],action:"",method:"POST",onSubmit:this.submitComment},m.a.createElement("div",null,m.a.createElement(F,{rows:3,autoSize:{minRows:3,maxRows:5},placeholder:"\u8fd8\u53ef\u4ee5\u8f93\u5165140\u4e2a\u5b57",value:this.state.content,onChange:this.handleContentChange,onPressEnter:this.hotKeySubmit})),m.a.createElement("div",{style:{marginTop:7}},m.a.createElement(S.a,{htmlType:"submit"},m.a.createElement(O.a,{type:"rocket"}),"\u53d1\u8868(Ctrl+Enter)")))}},{key:"handleContentChange",value:function(t){this.setState({content:t.target.value})}},{key:"hotKeySubmit",value:function(t){(t.ctrlKey||t.metaKey)&&this.submitComment(t)}},{key:"submitComment",value:function(t){var e=this;if(t.preventDefault(),this.state.content.trim()){var n={quoteId:this.props.quote?this.props.quote.comment_id:0,content:this.state.content.trim()};this.props.submitComment(n).then((function(){e.setState({content:""})})).catch((function(t){console.log(t.message)}))}}}]),e}(m.a.Component);var A=Object(l.b)((function(t){return{comments:t.comments}}),(function(t){var e=!1;return{submitComment:function(n){return e?new Promise((function(t,e){j.a.error("\u8bc4\u8bba\u6b63\u5728\u63d0\u4ea4\u4e2d\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01"),e(new Error("\u8bc4\u8bba\u6b63\u5728\u63d0\u4ea4\u4e2d\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01"))})):(e=!0,t(k(n)).payload.request.then((function(n){0!==n.data.status.code?j.a.error(n.data.status.message):(j.a.success("\u8bc4\u8bba\u53d1\u8868\u6210\u529f\uff01"),t(w(1)).payload.request.then((function(e){t(T(e.data.total,e.data.comments))})).catch((function(e){t(T(0,[]))}))),e=!1})).catch((function(t){e=!1})))}}}))(R),U=n(124),Q=n.n(U),z=function(t){function e(t){var n;return Object(h.a)(this,e),(n=Object(C.a)(this,Object(_.a)(e).call(this,t))).reply=n.reply.bind(Object(E.a)(n)),n}return Object(b.a)(e,t),Object(d.a)(e,[{key:"UNSAFE_componentWillReceiveProps",value:function(t){this.setState({comment:t.comment})}},{key:"render",value:function(){var t=this.props.comment,e=this.props.rootComment,n=this.props.replyCommentId===t.comment_id&&this.props.replyRootCommentId===e.comment_id?m.a.createElement(A,{quote:this.props.comment}):null;return m.a.createElement("div",null,m.a.createElement("div",{className:Q.a["comment-toolbar"]},m.a.createElement("span",{onClick:this.reply},"\u56de\u590d")),n)}},{key:"reply",value:function(){var t=this.props.replyCommentId===this.props.comment.comment_id?null:this.props.comment.comment_id,e=this.props.rootComment.comment_id;this.props.changeShowFormIn(t,e)}}]),e}(m.a.Component);var K=Object(l.b)((function(t){return{replyCommentId:t.replyCommentId,replyRootCommentId:t.replyRootCommentId}}),(function(t){return{changeShowFormIn:function(e,n){return t(N(e,n))}}}))(z),H=n(38),P=n.n(H),B=new RegExp("(https?://href.lu/[A-Za-z0-9]{2,8})","gi");function G(t){for(var e=t.split(B),n=1,o=e.length;n<o;n+=2)e[n]=m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:e[n]},m.a.createElement(O.a,{type:"link"}),"\u7f51\u9875\u94fe\u63a5");return e}var L=function(t){function e(){return Object(h.a)(this,e),Object(C.a)(this,Object(_.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(d.a)(e,[{key:"render",value:function(){var t=this.props.comment,n=t.quote?m.a.createElement(e,{rootComment:this.props.rootComment,comment:t.quote,onCommentSubmit:this.props.onCommentSubmit}):null,o=G(t.content),a=t.trashed?m.a.createElement(O.a,{type:"exclamation-circle-o",style:{color:"#F39C12"}}):null,c=P.a["comment-quote-author-title"]+" "+P.a["comment-quote-author-title-"+t.author_level];return m.a.createElement("div",{className:P.a["comment-quote"]},n,m.a.createElement("div",{className:P.a["comment-quote-body"]},m.a.createElement("div",{className:P.a["comment-quote-author"]},m.a.createElement("span",{className:P.a["comment-quote-author-username"]},t.username)," ",m.a.createElement("span",{className:c},t.author_title)),m.a.createElement("div",{className:P.a["comment-quote-content"]},m.a.createElement("p",null,a,o),m.a.createElement(K,{rootComment:this.props.rootComment,comment:t,onCommentSubmit:this.props.onCommentSubmit}))))}}]),e}(m.a.Component),W=n(29),J=n.n(W),Y=function(t){function e(){return Object(h.a)(this,e),Object(C.a)(this,Object(_.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(d.a)(e,[{key:"render",value:function(){var t=this.props.comment,e=t.quote?m.a.createElement(L,{rootComment:t,comment:t.quote,onCommentSubmit:this.props.onCommentSubmit}):null,n=G(t.content),o=t.trashed?m.a.createElement(O.a,{type:"exclamation-circle-o",style:{color:"#F39C12"}}):null,a=J.a["comment-author-title"]+" "+J.a["comment-author-title-"+t.author_level];return m.a.createElement("div",{id:"comment_"+t.comment_id,className:J.a["comment-item"]},m.a.createElement("div",{className:J.a["comment-avatar"]},m.a.createElement("img",{width:"35",height:"35",src:t.avatar,alt:t.username})),m.a.createElement("div",{className:J.a["comment-body"]},m.a.createElement("div",{className:J.a["comment-body-inner"]},m.a.createElement("div",{className:J.a["comment-author"]},m.a.createElement("span",{className:J.a["comment-author-username"]},t.username)," ",m.a.createElement("span",{className:a},t.author_title),m.a.createElement("span",{style:{float:"right"}},t.created_at)),e,m.a.createElement("p",{className:J.a["comment-content"]},o,n),m.a.createElement(K,{rootComment:t,comment:t,onCommentSubmit:this.props.onCommentSubmit}))))}}]),e}(m.a.Component),Z=n(125),D=n.n(Z),V=v.a.TabPane,X=function(t){function e(t){var n;return Object(h.a)(this,e),(n=Object(C.a)(this,Object(_.a)(e).call(this,t))).fetchComments=n.fetchComments.bind(Object(E.a)(n)),n}return Object(b.a)(e,t),Object(d.a)(e,[{key:"UNSAFE_componentWillMount",value:function(){this.fetchComments(1)}},{key:"render",value:function(){var t=this,e=this.props.comments.map((function(e){return m.a.createElement(Y,{key:e.comment_id,rootComment:e,comment:e,onCommentSubmit:t.props.onCommentSubmit})}));return m.a.createElement(v.a,null,m.a.createElement(V,{tab:this.props.total+" \u6761\u8bc4\u8bba",key:"1"},m.a.createElement("div",null,m.a.createElement(f.a,{spinning:this.props.loading},m.a.createElement("div",{className:D.a["comment-list"]},e)),m.a.createElement(y.a,{defaultCurrent:1,defaultPageSize:5,total:this.props.total,style:{marginTop:20},size:"small",onChange:this.fetchComments}))))}},{key:"fetchComments",value:function(t){this.props.fetchComments(t)}}]),e}(m.a.Component);var $=Object(l.b)((function(t){return{loading:t.loading,total:t.total,comments:t.comments}}),(function(t){return{fetchComments:function(e){t(w(e)).payload.request.then((function(e){t(T(e.data.total,e.data.comments))})).catch((function(e){t(T(0,[]))}))}}}))(X),tt=n(128),et=n.n(tt),nt=function(t){function e(){return Object(h.a)(this,e),Object(C.a)(this,Object(_.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(d.a)(e,[{key:"render",value:function(){return m.a.createElement(s.a,null,m.a.createElement(p.a,{span:24},m.a.createElement("hr",{className:et.a["comment-line"]}),m.a.createElement(A,null),m.a.createElement($,null)))}}]),e}(m.a.Component),ot={logged:!0,total:0,comments:[],replyCommentId:null,replyRootCommentId:null,loading:!1},mt=(n(250),Object(r.a)(i.a)(r.c)((function(t,e){var n=Object.assign({},t);return null==t?n=ot:"CHANGE_FORM"===e.type?(n.replyCommentId=e.payload.replyCommentId,n.replyRootCommentId=e.payload.replyRootCommentId,n):"SUBMIT_COMMENT"===e.type?(n.replyCommentId=e.payload.replyCommentId,n):"FETCH_COMMENTS"===e.type?(n.loading=!0,n):"FETCH_COMMENTS_SUCCESS"===e.type?(n.total=e.payload.total,n.comments=e.payload.comments,n.loading=!1,n):n})));var at=function(){return m.a.createElement(l.a,{store:mt},m.a.createElement(nt,null))};c.a.render(m.a.createElement(at,null),document.getElementById("comment_box"))},29:function(t,e,n){t.exports={"comment-item":"CommentItem_comment-item__1w7fh","comment-avatar":"CommentItem_comment-avatar__yWfn6","comment-author":"CommentItem_comment-author__P5iG1","comment-author-username":"CommentItem_comment-author-username__SqalR","comment-author-title":"CommentItem_comment-author-title__I8Fte","comment-author-title-a":"CommentItem_comment-author-title-a__2lU_y","comment-author-title-b":"CommentItem_comment-author-title-b__WHwOr","comment-author-title-c":"CommentItem_comment-author-title-c__3kOzA","comment-body":"CommentItem_comment-body__1oplL","comment-body-inner":"CommentItem_comment-body-inner__tSZoe","comment-content":"CommentItem_comment-content__2wzF7"}},38:function(t,e,n){t.exports={"comment-quote":"CommentQuote_comment-quote__xvKIE","comment-quote-body":"CommentQuote_comment-quote-body__1SzOy","comment-quote-author":"CommentQuote_comment-quote-author__VCtTX","comment-quote-author-username":"CommentQuote_comment-quote-author-username__uYMsb","comment-quote-author-title":"CommentQuote_comment-quote-author-title__3LGL2","comment-quote-author-title-a":"CommentQuote_comment-quote-author-title-a__2UmvU","comment-quote-author-title-b":"CommentQuote_comment-quote-author-title-b__3Rk6y","comment-quote-author-title-c":"CommentQuote_comment-quote-author-title-c__2ot1K","comment-quote-content":"CommentQuote_comment-quote-content__jwYU7"}}},[[135,1,2]]]);